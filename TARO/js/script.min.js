let table,cardsData;function go(){let e=document.querySelector(".progress");new Promise(e=>setTimeout(()=>e(),2e3)).then(()=>(table.innerHTML="",e.classList.remove("hidden"),e)).then(e=>(setTimeout(()=>{e.querySelector(".progress__fill").classList.add("progress__fill--full")},100),e)).then(e=>{let t=e.querySelector(".progress__fill"),r=e.querySelector(".progress__text");return setTimeout(()=>(r.innerHTML="<p>Your Tarot reading is ready!</p><p>Click below to get it now:</p>",t.innerHTML="<p>Get my reading</p>",e),1500),t}).then(e=>{e.addEventListener("click",showForm),e.style="cursor:pointer;"})}function showForm(){document.querySelector("#form").classList.remove("hidden"),document.querySelector(".card-progress").classList.add("hidden"),document.querySelector(".progress").classList.add("hidden"),document.querySelector(".table").classList.add("hidden"),document.querySelector(".form__input--submit").addEventListener("click",formSubmit),document.querySelector("#google").addEventListener("click",authGoogle),document.querySelector("#facebook").addEventListener("click",authFacebook)}async function formSubmit(e){e.preventDefault();let t=document.querySelector("#form");(function(){let e=!1;if(inputs=t.querySelectorAll("input"),inputs.forEach(t=>{var r;(r=t).classList.contains("mail")&&(/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/.test(r.value)||(e=!0,r.classList.add("err")))}),!e)return!0})()&&showResult(await async function(){let e=new FormData(t);return e.append("ids",cardsData.map(e=>e.id)),await fetch("/",{method:"POST",body:e})}())}function showResult(e){if(e.ok){JSON.parse(e)}else{document.querySelector("#form").classList.add("hidden"),document.querySelector(".advertisement2").classList.add("hidden"),putCards(document.querySelector(".prediction").querySelectorAll(".card"),cardsData),putText(document.querySelector(".prediction__text"),cardsData),document.querySelector(".prediction").classList.remove("hidden"),document.querySelector(".advertisement3").classList.remove("hidden")}}function authGoogle(e){e.preventDefault()}function authFacebook(e){e.preventDefault()}function randomId(e,t){let r=e+Math.random()*(t+1-e);return Math.floor(r)}function putCards(e,t){i=0,e.forEach(e=>{e.querySelector(".card__side--front").innerHTML=`<img src="img/${t[i].image}" alt="${t[i].imageAlt}">`,i++})}function putText(e,t){e.innerHTML=`<p>${t[0].prediction}</p><p>${t[1].prediction}</p><p>${t[2].prediction}</p>`}function getBackendData(){let e=[0,1,2,3,4,5,6],t=function(){let t=[];for(let r=6;r>3;r--){let o=randomId(0,r);t.push(e[o]),e.splice(o,1)}return t}(),r=JSON.parse(document.querySelector("#service").innerHTML);return JSON.stringify(function(){let e=[];for(let o=0;o<3;o++)e[o]=r[t[o]];return e}())}document.addEventListener("DOMContentLoaded",()=>{table=document.querySelector(".table"),cardsData=JSON.parse(getBackendData());let e=0,t=document.querySelector(".table").querySelectorAll(".card"),r=document.querySelector(".card-progress__subtitle"),o=document.querySelector(".card-progress__bar--fill");function n(){function t(e,t,n){r.textContent=e,o.style.transition=t,o.style.width=n}this.classList.add("card--flip"),e++,this.removeEventListener("click",n),1==e&&t("Pick Card 1","0.1s linear","7.9%"),2==e&&t("Pick Card 2","0.6s linear","54%"),3==e&&(t("Done","0.4s linear","100%"),setTimeout(go(),500))}putCards(t,cardsData),t.forEach(e=>e.addEventListener("click",n)),document.querySelector(".form__input--submit").addEventListener("click",formSubmit),document.querySelector("#google").addEventListener("click",authGoogle),document.querySelector("#facebook").addEventListener("click",authFacebook)});